// const {
//     GoogleGenerativeAI,
//     HarmCategory,
//     HarmBlockThreshold,
//   } = require("@google/generative-ai");
//   const fs = require("node:fs");
//   const mime = require("mime-types");
  
import { GoogleGenerativeAI } from "@google/generative-ai";

  const apiKey = import.meta.env.VITE_GOOGLE_GEMINI_AI_API_KEY;
  const genAI = new GoogleGenerativeAI(apiKey);
  
  const model = genAI.getGenerativeModel({
    model: "gemini-1.5-flash",
  });
  
  const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 40, 
    maxOutputTokens: 8192,
    responseModalities: [
    ],
    responseMimeType: "application/json",
  };
  

   export const chatSession = model.startChat({
      generationConfig,
      history: [
        {
          role: "user",
          parts: [
            {text: "Generate Travel Plan for Location: Las Vegas, for 3 Days for Couple with a cheap budget, Give me a Hotels options list with Hotel Name, Hotel address, price , hotel image URL, geo coordinates, rating, description and suggest itinerary with place Name, place Details, place Image URL, geo coordinates, ticket Pricing, time  travel each of the location for 3 days with each day plan with best time to visit in JSON format.\n"},
          ],
        },
        {
          role: "model",
          parts: [
             {text: "```json\n{\n  \"travelPlan\": {\n    \"location\": \"Las Vegas, Nevada, USA\",\n    \"duration\": \"3 Days\",\n    \"travelerType\": \"Couple\",\n    \"budgetFocus\": \"Cheap / Budget-Friendly\",\n    \"description\": \"A 3-day itinerary focused on experiencing the iconic sights and free attractions of Las Vegas without breaking the bank, suitable for a couple.\"\n  },\n  \"hotelOptions\": [\n    {\n      \"hotelName\": \"Ellis Island Hotel Casino & Brewery\",\n      \"hotelAddress\": \"4178 Koval Ln, Las Vegas, NV 89109\",\n      \"price\": \"$ (Typically $40-$120/night + resort fee, variable)\",\n      \"hotelImageURL\": \"https://images.trvl-media.com/lodging/1000000/10000/7700/7677/e1c3c17a.jpg?impolicy=fcrop&w=1200&h=800&p=1&q=medium\",\n      \"geoCoordinates\": {\n        \"latitude\": 36.1141,\n        \"longitude\": -115.1651\n      },\n      \"rating\": \"3.5-4 stars (Guest Rating)\",\n      \"description\": \"A popular budget-friendly option located just off the Strip. Known for its brewery, affordable dining (especially steak special), and lively casino floor. Basic but clean rooms.\"\n    },\n    {\n      \"hotelName\": \"Flamingo Las Vegas Hotel & Casino\",\n      \"hotelAddress\": \"3555 S Las Vegas Blvd, Las Vegas, NV 89109\",\n      \"price\": \"$$ (Typically $50-$180/night + resort fee, highly variable)\",\n      \"hotelImageURL\": \"https://images.trvl-media.com/lodging/1000000/10000/1800/1728/70405d18.jpg?impolicy=fcrop&w=1200&h=800&p=1&q=medium\",\n      \"geoCoordinates\": {\n        \"latitude\": 36.1163,\n        \"longitude\": -115.1706\n      },\n      \"rating\": \"3.5-4 stars (Guest Rating)\",\n      \"description\": \"A classic, centrally located Strip hotel offering a vibrant atmosphere. Features the free Wildlife Habitat and often has competitive room rates, especially for its prime location. Rooms vary in age/renovation.\"\n    },\n    {\n      \"hotelName\": \"The LINQ Hotel + Experience\",\n      \"hotelAddress\": \"3535 S Las Vegas Blvd, Las Vegas, NV 89109\",\n      \"price\": \"$$ (Typically $50-$190/night + resort fee, highly variable)\",\n      \"hotelImageURL\": \"https://images.trvl-media.com/lodging/9000000/8370000/8360600/8360511/6f655779.jpg?impolicy=fcrop&w=1200&h=800&p=1&q=medium\",\n      \"geoCoordinates\": {\n        \"latitude\": 36.1176,\n        \"longitude\": -115.1710\n      },\n      \"rating\": \"4 stars (Guest Rating)\",\n      \"description\": \"Modern hotel in the heart of the Strip, connected to the LINQ Promenade. Often offers good deals for its central location and updated rooms. Caters to a younger crowd.\"\n    },\n    {\n      \"hotelName\": \"Excalibur Hotel & Casino\",\n      \"hotelAddress\": \"3850 S Las Vegas Blvd, Las Vegas, NV 89109\",\n      \"price\": \"$ (Typically $30-$150/night + resort fee, variable)\",\n      \"hotelImageURL\": \"https://images.trvl-media.com/lodging/1000000/20000/11700/11617/e779114f.jpg?impolicy=fcrop&w=1200&h=800&p=1&q=medium\",\n      \"geoCoordinates\": {\n        \"latitude\": 36.1019,\n        \"longitude\": -115.1749\n      },\n      \"rating\": \"3 stars (Guest Rating)\",\n      \"description\": \"Iconic castle-themed hotel on the South Strip. Known for very budget-friendly rates, though rooms can be dated. Good option if price is the absolute priority. Connected by tram to Luxor and Mandalay Bay.\"\n    }\n  ],\n  \"itinerary\": [\n    {\n      \"day\": \"Day 1: Arrival & South Strip Wonders\",\n      \"schedule\": [\n        {\n          \"time\": \"Afternoon (e.g., 2:00 PM)\",\n          \"placeName\": \"Hotel Check-in\",\n          \"placeDetails\": \"Arrive in Las Vegas, check into your chosen budget-friendly hotel. Settle in and leave your luggage.\",\n          \"placeImageURL\": \"https://example.com/placeholder_checkin.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1149,\n            \"longitude\": -115.1728\n          },\n          \"ticketPricing\": \"N/A (Hotel Cost)\",\n          \"bestTimeToVisit\": \"Standard check-in times apply (usually 3 PM or 4 PM)\",\n          \"estimatedTravelTime\": \"Variable depending on arrival method\"\n        },\n        {\n          \"time\": \"Late Afternoon (e.g., 4:00 PM)\",\n          \"placeName\": \"Welcome to Fabulous Las Vegas Sign\",\n          \"placeDetails\": \"Take a bus (Deuce) or rideshare south to the iconic sign for a classic Vegas photo op. Be prepared for a potential queue.\",\n          \"placeImageURL\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Welcome_to_Fabulous_Las_Vegas_sign.jpg/1280px-Welcome_to_Fabulous_Las_Vegas_sign.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.0820,\n            \"longitude\": -115.1729\n          },\n          \"ticketPricing\": \"Free\",\n          \"bestTimeToVisit\": \"Daylight hours for photos, less crowded earlier/later.\",\n          \"estimatedTravelTime\": \"15-30 mins (Bus/Rideshare from mid-Strip)\"\n        },\n        {\n          \"time\": \"Early Evening (e.g., 5:30 PM)\",\n          \"placeName\": \"South Strip Exploration (Walk)\",\n          \"placeDetails\": \"Walk north from the sign area (or take bus back part way). Explore the exteriors and lobbies of Mandalay Bay, Luxor (pyramid & sphinx), and Excalibur (castle). Enjoy the unique architecture.\",\n          \"placeImageURL\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/89/Luxor_Hotel_and_Casino_IMG_5310_3-13-2010.JPG/1280px-Luxor_Hotel_and_Casino_IMG_5310_3-13-2010.JPG\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1019,\n            \"longitude\": -115.1749\n          },\n          \"ticketPricing\": \"Free (to walk around)\",\n          \"bestTimeToVisit\": \"Late afternoon / Early evening\",\n          \"estimatedTravelTime\": \"Ongoing (Walking)\"\n        },\n         {\n          \"time\": \"Evening (e.g., 7:00 PM)\",\n          \"placeName\": \"Budget Dinner\",\n          \"placeDetails\": \"Find an affordable dinner option. Consider food courts (e.g., inside Excalibur/Luxor), Ocean One Bar & Grille (Miracle Mile Shops - known for lunch deals, check dinner prices), or happy hour deals nearby.\",\n          \"placeImageURL\": \"https://example.com/placeholder_foodcourt.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1100,\n            \"longitude\": -115.1720\n          },\n          \"ticketPricing\": \"$ (Approx $10-20 per person)\",\n          \"bestTimeToVisit\": \"Dinner time\",\n          \"estimatedTravelTime\": \"5-15 mins (Walking)\"\n        },\n        {\n          \"time\": \"Night (e.g., 8:30 PM onwards)\",\n          \"placeName\": \"Bellagio Fountains & Conservatory\",\n          \"placeDetails\": \"Walk or take the Deuce bus north to the Bellagio. Witness the spectacular free fountain show (runs every 15-30 mins). Afterwards, visit the stunning, seasonally themed Bellagio Conservatory & Botanical Gardens inside (also free).\",\n          \"placeImageURL\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Las_Vegas_Bellagio_Brunnen_ Fountain_Show_2013_adjusted.jpg/1920px-Las_Vegas_Bellagio_Brunnen_ Fountain_Show_2013_adjusted.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1126,\n            \"longitude\": -115.1746\n          },\n          \"ticketPricing\": \"Free\",\n          \"bestTimeToVisit\": \"Evening/Night (Fountains best after dark, Conservatory anytime)\",\n          \"estimatedTravelTime\": \"15-25 mins (Walking/Bus from South Strip)\"\n        }\n      ]\n    },\n    {\n      \"day\": \"Day 2: Mid-Strip Marvels & Downtown Fun\",\n      \"schedule\": [\n        {\n          \"time\": \"Morning (e.g., 10:00 AM)\",\n          \"placeName\": \"Flamingo Wildlife Habitat\",\n          \"placeDetails\": \"Visit the serene and free wildlife habitat at the Flamingo hotel, featuring flamingos, pelicans, turtles, and fish in a lush garden setting.\",\n          \"placeImageURL\": \"https://vegasexperience.com/wp-content/uploads/2022/09/Flamingo-Wildlife-Habitat-Featured.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1168,\n            \"longitude\": -115.1704\n          },\n          \"ticketPricing\": \"Free\",\n          \"bestTimeToVisit\": \"Morning/Daylight hours\",\n          \"estimatedTravelTime\": \"Variable (Depending on hotel location)\"\n        },\n        {\n          \"time\": \"Late Morning (e.g., 11:00 AM)\",\n          \"placeName\": \"LINQ Promenade & High Roller (View)\",\n          \"placeDetails\": \"Stroll through the LINQ Promenade, an open-air retail, dining, and entertainment district. Get a view of the High Roller observation wheel (riding it is optional and costs extra, look for deals if interested).\",\n          \"placeImageURL\": \"https://resorts.caesars.com/content/dam/empire/lnq/hotel/attractions/promenade/lnq-promenade-shops-day-1638-cropped-16x9.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1176,\n            \"longitude\": -115.1700\n          },\n          \"ticketPricing\": \"Free (to walk Promenade), $$ (High Roller ticket)\",\n          \"bestTimeToVisit\": \"Daytime or Evening\",\n          \"estimatedTravelTime\": \"5-10 mins (Walking from Flamingo)\"\n        },\n        {\n          \"time\": \"Lunch (e.g., 12:30 PM)\",\n          \"placeName\": \"Budget Lunch on the Strip\",\n          \"placeDetails\": \"Grab an affordable lunch. Options include In-N-Out Burger (near LINQ), food courts (e.g., Venetian/Palazzo Grand Canal Shoppes), or pizza slices.\",\n          \"placeImageURL\": \"https://example.com/placeholder_burger.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1180,\n            \"longitude\": -115.1705\n          },\n          \"ticketPricing\": \"$ (Approx $10-15 per person)\",\n          \"bestTimeToVisit\": \"Lunchtime\",\n          \"estimatedTravelTime\": \"5-10 mins (Walking)\"\n        },\n        {\n          \"time\": \"Afternoon (e.g., 2:00 PM)\",\n          \"placeName\": \"Venetian & Palazzo Exploration\",\n          \"placeDetails\": \"Walk through The Venetian and The Palazzo resorts. Admire the replicas of Venice's canals (gondola rides cost extra), St. Mark's Square, and the opulent architecture and painted ceilings. Free to wander and window shop.\",\n          \"placeImageURL\": \"https://upload.wikimedia.org/wikipedia/commons/3/33/Las_Vegas_Venetian_Hotel_Innenansicht.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1215,\n            \"longitude\": -115.1720\n          },\n          \"ticketPricing\": \"Free (to walk around)\",\n          \"bestTimeToVisit\": \"Anytime\",\n          \"estimatedTravelTime\": \"10-15 mins (Walking from LINQ area)\"\n        },\n        {\n          \"time\": \"Late Afternoon (e.g., 4:30 PM)\",\n          \"placeName\": \"Travel to Downtown Las Vegas (Fremont St)\",\n          \"placeDetails\": \"Take the Deuce bus (runs along the Strip) north to Downtown Las Vegas / Fremont Street Experience. Allow ample travel time.\",\n          \"placeImageURL\": \"https://www.reviewjournal.com/wp-content/uploads/2021/09/15594801_web1_DEUCE-SEP21-21-BT-002.jpg?w=1200\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1700,\n            \"longitude\": -115.1400\n          },\n          \"ticketPricing\": \"$ (Bus fare, approx $6 for 2-hour pass or $8 for 24-hour pass)\",\n          \"bestTimeToVisit\": \"N/A (Travel time)\",\n          \"estimatedTravelTime\": \"30-50 mins (Bus depending on traffic)\"\n        },\n        {\n          \"time\": \"Evening (e.g., 5:30 PM onwards)\",\n          \"placeName\": \"Fremont Street Experience\",\n          \"placeDetails\": \"Explore historic Downtown Las Vegas. Walk under the massive Viva Vision canopy (light shows start hourly in the evening), soak in the vintage Vegas vibe, see street performers, and maybe grab a cheaper drink or dinner at one of the older casinos or eateries.\",\n          \"placeImageURL\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/Fremont_Street_Experience%2C_Las_Vegas.jpg/1920px-Fremont_Street_Experience%2C_Las_Vegas.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1703,\n            \"longitude\": -115.1426\n          },\n          \"ticketPricing\": \"Free (Light shows & walking). Optional costs for SlotZilla zipline, food/drinks.\",\n          \"bestTimeToVisit\": \"Evening/Night (for light shows and atmosphere)\",\n          \"estimatedTravelTime\": \"Ongoing (Walking Downtown)\"\n        }\n      ]\n    },\n    {\n      \"day\": \"Day 3: Unique Finds & Departure Prep\",\n      \"schedule\": [\n        {\n          \"time\": \"Morning (e.g., 10:00 AM)\",\n          \"placeName\": \"Relax / Optional Free Activity\",\n          \"placeDetails\": \"Enjoy a relaxed morning. Depending on your hotel, use the pool (weather permitting). Alternatively, revisit a favorite free spot like the Bellagio Conservatory or explore unique shops like M&M's World or Coca-Cola Store (free to browse).\",\n          \"placeImageURL\": \"https://example.com/placeholder_pool.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1149,\n            \"longitude\": -115.1728\n          },\n          \"ticketPricing\": \"Free\",\n          \"bestTimeToVisit\": \"Morning\",\n          \"estimatedTravelTime\": \"Variable (Depending on choice)\"\n        },\n        {\n          \"time\": \"Late Morning / Midday (e.g., 11:30 AM)\",\n          \"placeName\": \"Pinball Hall of Fame (Optional Budget Activity)\",\n          \"placeDetails\": \"Consider a visit to the Pinball Hall of Fame (new location on the Strip, south end). It's free to enter, pay per game (most are 25-75 cents). A fun, nostalgic, and cheap way to spend an hour or two. Requires bus/rideshare.\",\n          \"placeImageURL\": \"https://pinballmuseum.org/wp-content/uploads/2021/03/vegas-pinball-museum.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.0902,\n            \"longitude\": -115.1730\n          },\n          \"ticketPricing\": \"Free entry, $ (Pay per game, budget $5-15 per person)\",\n          \"bestTimeToVisit\": \"Anytime during open hours\",\n          \"estimatedTravelTime\": \"15-25 mins (Bus/Rideshare from mid-Strip)\"\n        },\n        {\n          \"time\": \"Lunch (e.g., 1:00 PM)\",\n          \"placeName\": \"Final Budget Lunch\",\n          \"placeDetails\": \"Have a final inexpensive lunch. Perhaps grab sandwiches from a convenience store/deli, find another food court, or revisit a cheap favorite.\",\n          \"placeImageURL\": \"https://example.com/placeholder_sandwich.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1149,\n            \"longitude\": -115.1728\n          },\n          \"ticketPricing\": \"$ (Approx $10-15 per person)\",\n          \"bestTimeToVisit\": \"Lunchtime\",\n          \"estimatedTravelTime\": \"Variable (Depending on choice)\"\n        },\n        {\n          \"time\": \"Afternoon (e.g., 2:30 PM)\",\n          \"placeName\": \"Last Minute Souvenirs / Pack\",\n          \"placeDetails\": \"Do some last-minute souvenir shopping at budget-friendly stores (e.g., Bonanza Gift Shop - 'World's Largest', or stores within Miracle Mile Shops/similar). Head back to the hotel to pack.\",\n          \"placeImageURL\": \"https://example.com/placeholder_souvenir.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1149,\n            \"longitude\": -115.1728\n          },\n          \"ticketPricing\": \"Free (to browse)\",\n          \"bestTimeToVisit\": \"Afternoon\",\n          \"estimatedTravelTime\": \"Variable\"\n        },\n        {\n          \"time\": \"Late Afternoon/Evening\",\n          \"placeName\": \"Departure\",\n          \"placeDetails\": \"Check out from your hotel and head to the airport or your next destination.\",\n          \"placeImageURL\": \"https://example.com/placeholder_airport.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.0840,\n            \"longitude\": -115.1537\n          },\n          \"ticketPricing\": \"N/A\",\n          \"bestTimeToVisit\": \"Allow ample time before flight\",\n          \"estimatedTravelTime\": \"20-40 mins (To LAS airport via rideshare/taxi)\"\n        }\n      ]\n    }\n  ],\n  \"notes\": [\n    \"Hotel prices are estimates and fluctuate wildly based on dates, events, and day of the week. Weekday stays are generally much cheaper.\",\n    \"Factor in mandatory Resort Fees ($25-$50+ per night) at most hotels, which are usually NOT included in the initial advertised price.\",\n    \"Transportation: Utilize walking for nearby attractions on the Strip. Use the Deuce bus ($8 for 24hr pass) for longer distances along the Strip and to Downtown. Rideshares (Uber/Lyft) are also available.\",\n    \"Food: Look for food courts, happy hour deals, buffets (check pricing as they've become less budget-friendly), and off-strip eateries for savings.\",\n    \"Free Entertainment: Besides Bellagio Fountains and Fremont Street, check schedules for free lounge acts in casinos or street performers.\",\n    \"Hydration: Carry water, especially when walking during warmer months. You can buy bottles affordably at convenience stores off the main casino floors.\",\n    \"Check current show times/availability for free attractions like Bellagio Fountains or Mirage Volcano (if applicable/running) as schedules can change.\"\n  ]\n}\n```"},
        ],
        },
      ],
    });
  
  